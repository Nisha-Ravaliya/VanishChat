<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard ‚Äî VanishChat</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: Arial, sans-serif; background: #f0f2f5; display: flex; min-height: 100vh; }

        aside.sidebar {
            width: 240px; background: #2c3e50; color: white;
            display: flex; flex-direction: column;
            padding: 20px; position: fixed; top: 60px; bottom: 0;
        }
        aside.sidebar h2 { text-align: center; margin-bottom: 20px; }
        aside.sidebar nav { flex-grow: 1; }
        aside.sidebar nav a {
            display: block; color: white; text-decoration: none;
            padding: 12px 15px; border-radius: 5px; margin-bottom: 10px;
            transition: 0.3s;
        }
        aside.sidebar nav a:hover, aside.sidebar nav a.active {
            background: #1abc9c; color: #2c3e50;
        }
        aside.sidebar button.logoutBtn{
            margin-top: auto; padding: 10px; border:none;
            border-radius:6px; background:#e74c3c; color:white; cursor:pointer;
        }
        aside.sidebar button.logoutBtn:hover{background:#c0392b;}

        header.topbar {
            position: fixed; top: 0; left: 0; right: 0; height: 60px;
            background: white; display: flex;
            align-items: center; justify-content: space-between;
            padding: 0 20px; box-shadow: 0 1px 4px rgba(0,0,0,0.1);
            z-index: 10;
        }
        header.topbar .search-container { flex:4; }
        header.topbar .search-container input{
            width: 100%; padding:8px 12px; border-radius:6px; border:1px solid #bbb;
        }
        header.topbar .user-info{
            display:flex; align-items:center; gap:10px;
        }
        header.topbar .user-info img{
            width:40px; height:40px; border-radius:50%; object-fit:cover;
        }
        header.topbar .bell{ position:relative; margin-right:20px; cursor:pointer; }
        header.topbar .bell span{
            position:absolute; top:-5px; right:-5px;
            background:red; color:white; font-size:12px;
            padding:2px 6px; border-radius:50%;
        }
        header.topbar .notifications{
            position:absolute; right:0; top:45px; background:white;
            width:250px; max-height:300px; overflow:auto;
            box-shadow:0 2px 8px rgba(0,0,0,0.2); display:none;
            border-radius:8px; z-index:20;
        }
        header.topbar .notifications p{
            padding:10px; border-bottom:1px solid #eee;
        }

        main.content {
            margin-left: 240px; margin-top:60px; padding: 20px;
            width: calc(100% - 240px); height: calc(100vh - 60px); overflow-y:auto;
        }

        section { display: none; }

        .card {
            background: #ecf0f1; padding: 20px; border-radius: 8px;
            border:1px solid #ddd; margin-bottom: 20px;
        }

        img.profile-pic{width:100px; height:100px; border-radius:50%; object-fit:cover;}

        .chat-card{ background:#ecf0f1; padding:15px; border-radius:8px;
            max-height:400px; overflow-y:auto; margin-bottom:10px;}
        .chat-input{ display:flex; gap:10px; margin-top:10px;}
        .chat-message{ margin-bottom:10px; padding:8px 10px; border-radius:6px;
            background:#fff; border:1px solid #ccc;}
    </style>
</head>
<body>

<!-- Sidebar -->
<aside class="sidebar">
    <h2>VanishChat</h2>
    <nav>
        <a href="#" class="active" onclick="showPage('dashboard',event)">üè† Dashboard</a>
        <a href="#" onclick="showPage('chat',event)">üí¨ Chat</a>
        <a href="#" onclick="showPage('profile',event)">üë§ Profile</a>
        <a href="#" onclick="showPage('editProfile',event)">‚úèÔ∏è Edit Profile</a>
        <a href="#" onclick="showPage('settings',event)">‚öôÔ∏è Settings</a>
    </nav>
    <button class="logoutBtn" onclick="logout()">Logout</button>
</aside>

<!-- Topbar -->
<header class="topbar">
    <div class="search-container">
        <input type="text" placeholder="Search...">
    </div>

    <div class="bell" onclick="toggleNotifications()">
        üîî <span id="notificationCount">0</span>
        <div class="notifications" id="notificationList"></div>
    </div>

    <div class="user-info">
        <img id="topProfilePic" src="https://via.placeholder.com/40">
        <span id="topUserName">User</span>
    </div>
</header>

<!-- Main Content -->
<main class="content">

    <!-- Dashboard -->
    <section id="dashboard" style="display:block;">
        <h1>Dashboard</h1>
        <div class="card">
            <p><b>Name:</b> <span id="userNameDisplay"></span></p>
            <p><b>Email:</b> <span id="userEmailDisplay"></span></p>
            <p><b>Business:</b> <span id="userBusinessDisplay"></span></p>
            <p><b>Address:</b> <span id="userAddressDisplay"></span></p>
        </div>
    </section>

    <!-- Chat -->
    <section id="chat">
        <h1>Chat</h1>
        <div class="chat-card" id="chatContainer"></div>

        <div class="chat-input">
            <input type="email" id="chatEmail" placeholder="Recipient Email">
            <input type="text" id="chatMessage" placeholder="Message">
            <button onclick="sendMessage()">Send</button>
        </div>
    </section>

    <!-- Profile -->
    <section id="profile">
        <h1>Profile</h1>
        <div class="card">
            <img id="profilePic" class="profile-pic" src="https://via.placeholder.com/100">
            <input type="file" onchange="previewProfilePic(event)">
            <p><b>Name:</b> <span id="profileName"></span></p>
            <p><b>Email:</b> <span id="profileEmail"></span></p>
            <p><b>Business:</b> <span id="profileBusiness"></span></p>
            <p><b>Address:</b> <span id="profileAddress"></span></p>
        </div>
    </section>

    <!-- Edit Profile -->
    <section id="editProfile">
        <h1>Edit Profile</h1>
        <div class="card">
            <input id="editName">
            <input id="editEmail">
            <input id="editBusiness">
            <textarea id="editAddress"></textarea>
            <button onclick="saveProfile()">Save</button>
        </div>
    </section>

    <!-- Settings -->
    <section id="settings">
        <h1>Settings</h1>
        <div class="card">Coming Soon...</div>
    </section>

</main>

<script>

    /* -------------------------
        YOUR FULL JS IS SAME
       (NO CHANGES REMOVED)
    -------------------------- */

    /// ‚≠ê I am pasting the exact JS you had before ‚Äî unchanged
    /// ‚úî Only duplicate HTML was removed

    /* ------------------------------------------------------------
       USERS DATABASE
    ------------------------------------------------------------ */
    if (!localStorage.getItem("usersDB")) {
        localStorage.setItem("usersDB", JSON.stringify({
            "john@example.com": {
                name: "John Doe",
                email: "john@example.com",
                business: "My Business",
                address: "123 Street",
                profilePic: "",
                notifications: [],
                chats: []
            },
            "ram@example.com": {
                name: "Ram Kumar",
                email: "ram@example.com",
                business: "Lucky Store",
                address: "Delhi",
                profilePic: "",
                notifications: [],
                chats: []
            }
        }));
    }

    localStorage.setItem("loggedUser", "john@example.com");

    /* GET LOGGED USER */
    function getUser() {
        let db = JSON.parse(localStorage.getItem("usersDB"));
        return db[localStorage.getItem("loggedUser")];
    }

    function saveUser(user) {
        let db = JSON.parse(localStorage.getItem("usersDB"));
        db[user.email] = user;
        localStorage.setItem("usersDB", JSON.stringify(db));
    }

    /* LOAD UI */
    document.addEventListener("DOMContentLoaded", () => {
        let u = getUser();

        document.getElementById("topUserName").textContent = u.name;
        document.getElementById("topProfilePic").src = u.profilePic || "https://via.placeholder.com/40";

        document.getElementById("userNameDisplay").textContent = u.name;
        document.getElementById("userEmailDisplay").textContent = u.email;
        document.getElementById("userBusinessDisplay").textContent = u.business;
        document.getElementById("userAddressDisplay").textContent = u.address;

        document.getElementById("profileName").textContent = u.name;
        document.getElementById("profileEmail").textContent = u.email;
        document.getElementById("profileBusiness").textContent = u.business;
        document.getElementById("profileAddress").textContent = u.address;
        document.getElementById("profilePic").src = u.profilePic || "https://via.placeholder.com/100";

        document.getElementById("editName").value = u.name;
        document.getElementById("editEmail").value = u.email;
        document.getElementById("editBusiness").value = u.business;
        document.getElementById("editAddress").value = u.address;

        loadNotifications();
        renderChats();
    });

    /* PAGE SWITCH */
    function showPage(p,e){
        e.preventDefault();
        document.querySelectorAll("section").forEach(s=>s.style.display="none");
        document.getElementById(p).style.display="block";
        document.querySelectorAll(".sidebar nav a").forEach(a=>a.classList.remove("active"));
        e.target.classList.add("active");
    }

    /* PROFILE PIC */
    function previewProfilePic(event){
        const reader = new FileReader();
        reader.onload = ()=>{
            let u = getUser();
            u.profilePic = reader.result;
            saveUser(u);
            document.getElementById("profilePic").src = reader.result;
            document.getElementById("topProfilePic").src = reader.result;
        };
        reader.readAsDataURL(event.target.files[0]);
    }

    /* SAVE PROFILE */
    function saveProfile(){
        let u = getUser();
        u.name = editName.value;
        u.email = editEmail.value;
        u.business = editBusiness.value;
        u.address = editAddress.value;
        saveUser(u);
        alert("Profile Updated!");
        location.reload();
    }

    /* SEND MESSAGE */
    function sendMessage(){
        let to = chatEmail.value;
        let msg = chatMessage.value;

        if(!to || !msg) return alert("Enter details");

        let db =JSON.parse(localStorage.getItem("usersDB"));
        if(!db[to]) return alert("Recipient not found!");

        let sender = getUser();
        sender.chats.push({ to, msg, time: new Date().toLocaleString() });

        db[to].notifications.push({
            text:`New message from ${sender.email}`,
            time:new Date().toLocaleString()
        });

        db[sender.email] = sender;
        localStorage.setItem("usersDB", JSON.stringify(db));

        chatMessage.value = "";

        renderChats();
        alert("Message sent!");
    }

    /* RENDER CHATS */
    function renderChats(){
        let c = document.getElementById("chatContainer");
        c.innerHTML = "";
        getUser().chats.forEach(m=>{
            c.innerHTML += `
                <div class="chat-message">
                    <strong>To: ${m.to}</strong><br>
                    ${m.msg}<br>
                    <small>${m.time}</small>
                </div>
            `;
        });
    }

    /* NOTIFICATIONS */
    function loadNotifications(){
        let list = document.getElementById("notificationList");
        list.innerHTML = "";

        let u = getUser();

        if(u.notifications.length === 0){
            list.innerHTML = "<p>No notifications</p>";
        }

        u.notifications.forEach(n=>{
            list.innerHTML += `<p>${n.text} (${n.time})</p>`;
        });

        document.getElementById("notificationCount").textContent = u.notifications.length;
    }

    function toggleNotifications(){
        let box = document.getElementById("notificationList");
        box.style.display = box.style.display==="block" ? "none" : "block";
    }

    function logout(){
        alert("Logged out!");
    }

</script>

</body>
</html>
